B1. Code theo chuẩn mực (không code tùy tiện quá) cho ra chức năng đã 
B2. Sau đó tối ưu cho code ngắn lại 


Features 
+ Chat real time - socket - pusher  
+ Mutil auth (hệ thống đăng nhập 2 bảng : user và admin => @guest và @admin => đăng kí @admin trong Kernel.php)
+ OAth2 Google , Facebook (OK)
+ Send Mail (OK)
+ Deploy Laravel to infinity hoặc Railway 
+ Blog
+ Mở rộng tính năng cmt 





============================ Note ============================
- @guest là kiểm tra người dùng đã đăng nhập hay chưa 
    + đây là 1 role 
    + nếu 2 role thì sao ? 
    + đăng nhập bằng 2 bảng admin và user (key : mutilple - authetication)

- Bỏ quá nhiều folder trong vs code thì sẽ làm cho chức năng ctrl + click => di chuyển đến hàm sẽ không hoạt động nữa, 
    vì nó tìm quá nhiều file 


- Bật tắt thanh Debug trong Laravel : 
    + C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel>composer require barryvdh/laravel-debugbar --dev
    + env : APP_DEBUG=true # tắt thanh https://github.com/barryvdh/laravel-debugbar thì chuyển thành false 



=======================================================================



Câu lệnh	Mô tả
composer create-project --prefer-dist laravel/laravel <tên>	Tạo một project Laravel mới
php artisan serve	Chạy ứng dụng Laravel trên localhost
php artisan make:migration create_<tên-bảng>_table	Tạo migration mới để tạo bảng trong cơ sở dữ liệu
php artisan migrate	Chạy migration để tạo bảng trong cơ sở dữ liệu
php artisan make:model <tên-model>	Tạo model mới
php artisan make:controller <tên-controller>	Tạo controller mới
php artisan make:request <tên-request>	Tạo request mới
php artisan make:middleware <tên-middleware>	Tạo middleware mới
php artisan make:controller --resource <tên-controller>	Tạo resource controller mới
php artisan make:factory <tên-factory> --model=<tên-model>	Tạo factory mới
php artisan make:seeder <tên-seeder>	Tạo seeder mới
php artisan db:seed	Chạy seeder để điền dữ liệu vào cơ sở dữ liệu
php artisan make:route <tên-route>	Tạo mới một route
php artisan key:generate	Tạo một key ứng dụng Laravel
php artisan migrate:rollback	Xóa bảng trong cơ sở dữ liệu

======================================================================================================
Dưới đây là danh sách các directive (câu lệnh điều khiển) trong Laravel Blade Template Engine:
@extends: Được sử dụng để khai báo layout mà view sẽ kế thừa.
@section và @endsection: Được sử dụng để định nghĩa một section trong view.
@yield: Được sử dụng để khai báo một điểm gọi (yield) trong layout để các view con có thể đổ nội dung vào.
@include: Được sử dụng để include một view vào trong view hiện tại.
@if, @elseif và @else: Sử dụng để kiểm tra điều kiện và hiển thị nội dung tương ứng.
@isset và @empty: Sử dụng để kiểm tra xem một biến đã được định nghĩa và không rỗng hay không.
@unless: Tương tự như @if, nhưng kiểm tra điều kiện ngược lại.
@switch, @case và @default: Cho phép xử lý nhiều trường hợp và chọn một khối nội dung tương ứng dựa trên giá trị của biến.
@for: Dùng để lặp qua một phạm vi số lần xác định và hiển thị nội dung tương ứng cho mỗi lần lặp.
@foreach: Dùng để lặp qua một mảng hoặc một collection và hiển thị nội dung tương ứng cho mỗi phần tử.
@while: Sử dụng để lặp lại một đoạn mã trong khi một điều kiện cụ thể đúng.
@php và @endphp: Dùng để viết mã PHP trực tiếp trong template.
@verbatim và @endverbatim: Cho phép hiển thị một đoạn mã nguyên thủy mà không được xử lý như Blade syntax.
@stack và @push: Được sử dụng để quản lý stack (ngăn xếp) các section trong view.
@auth và @guest: Được sử dụng để kiểm tra xem người dùng đã đăng nhập hay chưa.
@error: Sử dụng để hiển thị các thông báo lỗi của validation.
@csrf: Tạo một hidden input chứa token CSRF (Cross-Site Request Forgery) để bảo vệ form.
Đây là một số directive phổ biến trong Laravel Blade, có thể giúp bạn xây dựng các template linh hoạt và mạnh mẽ trong ứng dụng Laravel của mình.



Cách 1 
public function index()
{
    # Nếu mà đã đã đăng nhập thì không vào được trang login nữa . 
    # Ta cũng có một cách khác đó là đăng kí middleware cho nó  
    // if(Auth::check()){
    //     return redirect("dashboard");
    // }
    return view('auth.login');
} 

Cách 2 
Đầu tiên, hãy tạo một middleware mới bằng cách chạy lệnh artisan:
go
Copy code
php artisan make:middleware RedirectIfAuthenticated
Mở file middleware vừa tạo (app/Http/Middleware/RedirectIfAuthenticated.php) và chỉnh sửa phương thức handle như sau:
php
Copy code
public function handle($request, Closure $next, $guard = null)
{
    if (Auth::guard($guard)->check()) {
        // Nếu người dùng đã đăng nhập, chuyển hướng đến trang dashboard
        return redirect()->route('dashboard');
    }

    // Ngược lại, tiếp tục xử lý request
    return $next($request);
}
Đăng ký middleware trong file app/Http/Kernel.php bằng cách thêm vào thuộc tính $routeMiddleware:
php
Copy code
protected $routeMiddleware = [
    // ...
    'guest' => \App\Http\Middleware\RedirectIfAuthenticated::class,
];
Bây giờ, bạn có thể sử dụng middleware guest trong các route mà bạn muốn kiểm tra xem người dùng đã đăng nhập hay chưa. Ví dụ:
php
Copy code
Route::get('/login', 'Auth\LoginController@showLoginForm')->name('login')->middleware('guest');
Route::get('/register', 'Auth\RegisterController@showRegistrationForm')->name('register')->middleware('guest');
Trong ví dụ trên, middleware guest sẽ được áp dụng cho các route /login và /register, đảm bảo rằng chỉ những người dùng chưa đăng nhập mới có thể truy cập vào các trang này. Nếu người dùng đã đăng nhập, middleware sẽ chuyển hướng người dùng đến trang dashboard.

Lưu ý rằng bạn cần đảm bảo rằng route dashboard đã được đăng ký và middleware auth được sử dụng để bảo vệ trang dashboard.





================================================================
+ trong blade thì kiểm tra đã đăng nhập hay chưa bằng @guest 
+ trong web.php (route) thì dùng : middleware(['auth'])
Route::middleware(['auth'])->group(function () {
    Route::get('dashboard', [CustomAuthController::class, 'dashboard']);
    Route::get('signout', [CustomAuthController::class, 'signOut'])->name('signout');
});
+ trong controller thì dùng : 
if(Auth::check()){
    return redirect("dashboard");
}



================================================================
+ Notify trong laravel : 
    + https://github.com/brian2694/laravel-toastr , https://www.souysoeng.com/2021/03/laravel-8x-toastr-notifications-example.html 
    + use Brian2694\Toastr\Facades\Toastr;
    
    + Toastr::info('message', 'title', ['options']);
    + Toastr::success('message', 'title', ['options']);
    + Toastr::warning('message', 'title', ['options']);
    + Toastr::error('message', 'title', ['options']);
    + Toastr::clear();
    + Toastr()->info('message', 'title', ['options']);

    + step 
        + composer require brian2694/laravel-toastr
        + thêm vào config/app.php
            + Brian2694\Toastr\ToastrServiceProvider::class,
            + 'Toastr'  => Brian2694\Toastr\Facades\Toastr::class,
        + php artisan vendor:publish
            => chọn số của package laravel-toastr => enter 
        + thêm vào body của trang web : 
            <script src="http://cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
            <script src="http://cdn.bootcss.com/toastr.js/latest/js/toastr.min.js"></script>
            {!! Toastr::message() !!}
        + thêm vào head của trang web : 
            <link rel="stylesheet" href="http://cdn.bootcss.com/toastr.js/latest/css/toastr.min.css"> 

================================================================
Login by Google tóm tắt : 
C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel>composer require laravel/socialite
C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel>composer require socialiteproviders/google
C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel>php artisan make:migration add_google_id_to_users_table
C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel\database\migrations\2023_06_29_075104_add_google_id_to_users_table.php
        <?php

        use Illuminate\Database\Migrations\Migration;
        use Illuminate\Database\Schema\Blueprint;
        use Illuminate\Support\Facades\Schema;

        class AddGoogleIdToUsersTable extends Migration
        {
            /**
            * Run the migrations.
            *
            * @return void
            */
            public function up()
            {
                Schema::table('users', function (Blueprint $table) {
                    $table->string('google_id')->nullable();
                });
            }

            public function down()
            {
                Schema::table('users', function (Blueprint $table) {            
                    $table->dropColumn('google_id');
                });
            }
        }
C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel>php artisan migrate
C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel\app\Models\User.php
        protected $fillable = [
            'name', 'email', 'password','google_id'
        ];
        => Nhớ thêm vào Model 
Google API : https://console.cloud.google.com/apis/credentials/oauthclient/1079359168744-ehm0qmfgmg4imvbk33n7d97t69sfjb87.apps.googleusercontent.com
    Authorized JavaScript origins : http://127.0.0.1:8000
    Authorized redirect URIs : http://localhost:8000/authorized/google/callback  <====
C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel\config\services.php
        'google' => [
            'client_id' => '1079359168744-ehm0qmfgmg4imvbk33n7d97t69sfjb87.apps.googleusercontent.com',
            'client_secret' => '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',
            'redirect' => 'http://localhost:8000/authorized/google/callback',    <==== đây là LINK đăng kí trên google API 
        ],
C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel\app\Http\Controllers\CustomAuthController.php
        // Login by Google 
        public function redirectToGoogle()
        {
            return Socialite::driver('google')->redirect();
        }
        public function handleGoogleCallback()
        {
            try {
                $user = Socialite::driver('google')->user();
                $finduser = User::where('google_id', $user->id)->first();
                if($finduser){ // nếu đã tồn tại thì cho vào dashboard 
                    Auth::login($finduser);
                    return redirect()->intended('dashboard');
                }else{// nếu chưa thì tạo account 
                    $newUser = User::create([
                        'name' => $user->name,
                        'email' => $user->email,
                        'google_id'=> $user->id,    
                        'password' => encrypt('123456vanmanh') // mật khẩu mặt định 
                    ]);
                    Auth::login($newUser);
                    return redirect()->intended('dashboard');
                }
            } catch (Exception $e) {
                dd($e->getMessage());
            }
        }
C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel\resources\views\auth\login.blade.php
        <div class="flex items-center justify-end mt-4">
            <a href="{{ url('authorized/google') }}">   <=== đây là link ở web.php 
                <img src="https://developers.google.com/identity/images/btn_google_signin_dark_normal_web.png" style="margin-left: 3em;">
            </a>
        </div>
C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel\routes\web.php
        Route::get('authorized/google', [CustomAuthController::class, 'redirectToGoogle']); <=== đây là link ở blade nhằm gọi đến hàm trong Controller 
        Route::get('authorized/google/callback', [CustomAuthController::class, 'handleGoogleCallback']);

C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel\app\Http\Controllers\CustomAuthController.php (update cho phù hợp)
        // User đăng kí  
        public function customRegistration(Request $request)
        {  
            $request->validate([
                'name' => 'required',
                'email' => 'required|email',
                'password' => 'required|min:6',
            ]);

            $findEmail = User::where('email', $request->email)->first();
            if($findEmail){
                if($findEmail['password']){
                    Toastr::error('Tài khoản đã tồn tại');
                    return redirect("register");
                }
                else { // chưa có password mà có email thì là tài khoản của google => cập nhật password 
                    $findEmail->update(['password' => Hash::make($request['password'])]);
                }
            }
            else {
                $data = $request->all();
                $user = User::create([
                    'name' => $data['name'],
                    'email' => $data['email'],
                    'password' => Hash::make($data['password'])
                ]);
                Toastr::success('Đăng kí tài khoản thành công !');
                $this->sendMail($user);
            }
            return redirect("dashboard")->withSuccess('You have signed-in');
        }
        // Login by Google 
        public function redirectToGoogle()
        {
            return Socialite::driver('google')->redirect();
        }
        public function handleGoogleCallback()
        {
            try {
                $user = Socialite::driver('google')->user();
                $finduser = User::where('google_id', $user->id)->first();
                if($finduser){ // nếu đã tồn tại thì cho vào dashboard 
                    Auth::login($finduser);
                    return redirect()->intended('dashboard');
                }else{// nếu chưa thì tạo account 
                    $findEmail = User::where('email', $user->email)->first();
                    if($findEmail){ // đã có trong hệ thống thì update id 
                        $findEmail->update(['google_id' => $user->id]);
                        Auth::login($findEmail); // xác nhận đã login 
                        Toastr::success('Đăng nhập thành công');
                    }
                    else { // chưa có thì tạo tài khoản 
                        $newUser = User::create([
                            'name' => $user->name,
                            'email' => $user->email,
                            'google_id'=> $user->id,    
                            // 'password' => encrypt('123456vanmanh') // mật khẩu mặt định 
                        ]);
                        Auth::login($newUser); // xác nhận đã login 
                        Toastr::success('Đăng kí thành công');
                        $this->sendMail($newUser);
                    }
                    return redirect()->intended('dashboard');
                }            
            } catch (Exception $e) {
                dd($e->getMessage());
            }
        }

=> XONG , sau đó xử lý gì ở Controller cho hợp lý thì xử lý .  
================================================================
    login bằng google 
        + nếu google_id này đã có trong db => cho login vào  
        + nếu google_id này chưa có trong db 
            + nếu email này chưa có trong db => tạo tài khoản mới (password để trống)
            + nếu email này đã có trong db => chỉ cần bổ sung thêm google id 
            
    user register 
        + mail đã tồn tại 
            + có password => không cho đăng kí nữa 
            + không có password => đây là tài khoản đăng nhập trước đó bằng google 
                => lấy password người dùng nhập bổ sung vào  
        + mail chưa tồn tại => đăng kí như bình thường 
================================================================
Login by Github cũng tương tự : Điều quan trọng của một social network là  
    + Đăng kí 
        + URL trang web : http://localhost:8000
        + URL callback  : http://localhost:8000/authorized/google/callback (ghi cái gì cũng được)
            + link này sẽ xuất hiện 2 chỗ nữa là 
                + file service.php => đăng kí cho hệ thống 
                + web.php => gọi hàm xử lý 

    + Sau khi đăng kí thì hệ thống bất kì sẽ trả về cho ta 2 thứ quan trọng 
        + Client ID : b1b1f3e7c5765cfd3510
        + Client secrets : 48474a596ae636bba226c9b0f704221f2fcc3bb7 
        => cộng với URL callback ta đã đăng kí 
        => 3 thông số này sẽ cho vào file service.php 

Các bước để đăng nhập bằng github (ngắn gọn) 
    + https://github.com/settings/applications/new
        Application name : Blog Laravel
        Homepage URL : http://localhost:8000
        Authorization callback URL : http://localhost:8000/authorized/github/callback
    
    + https://github.com/settings/applications/2246649
        Client ID : b1b1f3e7c5765cfd3510
        => Click 'Generate a new client secret' để tạo Client secrets : 48474a596ae636bba226c9b0f704221f2fcc3bb7 (copy lại ngay)
    
    + C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel>composer require laravel/socialite (nếu trước đó đã chạy lệnh này rồi thì thôi)
    + C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel>composer require socialiteproviders/github

    + C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel\config\services.php
        'github' => [
            'client_id' => 'b1b1f3e7c5765cfd3510',
            'client_secret' => '48474a596ae636bba226c9b0f704221f2fcc3bb7',
            'redirect' => 'http://localhost:8000/authorized/github/callback',
        ],

    + C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel\routes\web.php
        Route::get('authorized/github', [CustomAuthController::class, 'redirectToGithub']);
        Route::get('authorized/github/callback', [CustomAuthController::class, 'handleGithubCallback']);
        
    + C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel\resources\views\auth\login.blade.php
        <div style="display: flex;justify-content: center" class="flex items-center justify-end mt-2 mb-4">
            <a href="{{ url('authorized/github') }}">
                <img style="width: 200px" src="https://help.dropsource.com/wp-content/uploads/sites/4/2017/02/gh-login-button.png" style="margin-left: 3em;">
            </a>
        </div>

    + C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel\app\Http\Controllers\CustomAuthController.php
        // Login by Github 
        public function redirectToGithub()
        {
            return Socialite::driver('github')->redirect();
        }
        public function handleGithubCallback()
        {
            try {
                $user = Socialite::driver('github')->user();
                $finduser = User::where('github_id', $user->id)->first();
                if($finduser){ // nếu đã tồn tại thì cho vào dashboard 
                    Auth::login($finduser);
                    return redirect()->intended('dashboard');
                }else{// nếu chưa thì tạo account 
                    $findEmail = User::where('email', $user->email)->first();
                    if($findEmail){ // đã có trong hệ thống thì update id 
                        $findEmail->update(['github_id' => $user->id]);
                        Auth::login($findEmail); // xác nhận đã login 
                        Toastr::success('Đăng nhập thành công');
                    }
                    else { // chưa có thì tạo tài khoản 
                        $newUser = User::create([
                            'name' => $user->name,
                            'email' => $user->email,
                            'github_id'=> $user->id,    
                            // 'password' => encrypt('123456vanmanh') // mật khẩu mặt định 
                        ]);
                        Auth::login($newUser); // xác nhận đã login 
                        Toastr::success('Đăng kí thành công');
                        $this->sendMail($newUser);
                    }
                    return redirect()->intended('dashboard');
                }            
            } catch (Exception $e) {
                dd($e->getMessage());
            }
        }

    + C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel>php artisan make:migration add_github_id_to_users_table
        public function up()
        {
            Schema::table('users', function (Blueprint $table) {
                $table->string('github_id')->nullable();
            });
        }

        public function down()
        {
            Schema::table('users', function (Blueprint $table) {            
                $table->dropColumn('github_id');
            });
        }
    + C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel>php artisan migrate
    + C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel\app\Models\User.php
        protected $fillable = [
            'name', 'email', 'password','google_id','github_id'
        ];

    ==> XONG . Về cơ bản thì như vậy là ok rồi . Cứ làm giống như Login bằng Google là được . 

================================================================
    login bằng google 
        + nếu google_id này đã có trong db => cho login vào  
        + nếu google_id này chưa có trong db 
            + nếu email này chưa có trong db => tạo tài khoản mới (password để trống)
            + nếu email này đã có trong db => chỉ cần bổ sung thêm google id 
    
    login bằng github
        + nếu github_id này đã có trong db => cho login vào  
        + nếu github_id này chưa có trong db 
            + nếu email này chưa có trong db => tạo tài khoản mới (password để trống)
            + nếu email này đã có trong db => chỉ cần bổ sung thêm github id 

    user register 
        + mail đã tồn tại 
            + có password => không cho đăng kí nữa 
            + không có password => đây là tài khoản đăng nhập trước đó bằng mạng xã hội (google hoặc github,...)
                => lấy password người dùng nhập bổ sung vào  
        + mail chưa tồn tại => đăng kí như bình thường 

VỀ CỞ BẢN HOÀN TOÀN GIỐNG NHAU , KHÔNG ĐỔI GÌ CẢ , COPY ra và thay vào thôi . 
CODE CỦA GITHUB hoàn toàn giống GOOLE => Áp dụng cho các mạng xã hội khác 

+ Về xử lý maill unique => tưởng phức tạp , tưởng thêm một mạng xã hội thì lại phải xem lại cách xử lý sao maill 
    thì phải unique còn password khi đăng kí thì phải điền vào còn khi đăng nhập bằng mạng xã hội thì không điền 
    => thì mấy cái này do mình code ok nên khi thêm một mạng xã hội mới ví dụ github thì chỉ cần cop ra paste vào thôi 
================================================================
dd($user) Ta sẽ được : 
    Laravel\Socialite\Two\User {#417 ▼
        +token: "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"
        +refreshToken: null
        +expiresIn: null
        +approvedScopes: array:1 [▶]
        +id: 81563451
        +nickname: "NguyenVanManh-AI"
        +name: "Nguyễn Văn Mạnh"
        +email: "nguyenvanmanh2001it1@gmail.com"
        +avatar: "https://avatars.githubusercontent.com/u/81563451?v=4"
        +user: array:32 [▼
        "login" => "NguyenVanManh-AI"
        "id" => 81563451
        "node_id" => "MDQ6VXNlcjgxNTYzNDUx"
        "avatar_url" => "https://avatars.githubusercontent.com/u/81563451?v=4"
        "gravatar_id" => ""
        "url" => "https://api.github.com/users/NguyenVanManh-AI"
        "html_url" => "https://github.com/NguyenVanManh-AI"
        "followers_url" => "https://api.github.com/users/NguyenVanManh-AI/followers"
        "following_url" => "https://api.github.com/users/NguyenVanManh-AI/following{/other_user}"
        "gists_url" => "https://api.github.com/users/NguyenVanManh-AI/gists{/gist_id}"
        "starred_url" => "https://api.github.com/users/NguyenVanManh-AI/starred{/owner}{/repo}"
        "subscriptions_url" => "https://api.github.com/users/NguyenVanManh-AI/subscriptions"
        "organizations_url" => "https://api.github.com/users/NguyenVanManh-AI/orgs"
        "repos_url" => "https://api.github.com/users/NguyenVanManh-AI/repos"
        "events_url" => "https://api.github.com/users/NguyenVanManh-AI/events{/privacy}"
        "received_events_url" => "https://api.github.com/users/NguyenVanManh-AI/received_events"
        "type" => "User"
        "site_admin" => false
        "name" => "Nguyễn Văn Mạnh"
        "company" => "DUT-BACH KHOA DA NANG"
        "blog" => ""
        "location" => "DA NANG"
        "email" => "nguyenvanmanh2001it1@gmail.com"
        "hireable" => null
        "bio" => null
        "twitter_username" => "NguyenVanManhft"
        "public_repos" => 48
        "public_gists" => 13
        "followers" => 17
        "following" => 35
        "created_at" => "2021-03-29T10:44:36Z"
        "updated_at" => "2023-06-24T19:58:33Z"
        ]
        +attributes: array:5 [▼
        "id" => 81563451
        "nickname" => "NguyenVanManh-AI"
        "name" => "Nguyễn Văn Mạnh"
        "email" => "nguyenvanmanh2001it1@gmail.com"
        "avatar" => "https://avatars.githubusercontent.com/u/81563451?v=4"
        ]
    }
    

================================================================
Build App Chat Realtime 
    + https://www.youtube.com/watch?v=ER-wOKXrbuw&ab_channel=CodewithRoss 
    + https://bitbucket.org/rossedlin/chat-laravel-pusher/src/youtube/ 
    + https://dashboard.pusher.com/apps/1627143/getting_started
        => chủ yếu là dùng thư viện , nó không liên quan gì database hết 
        => nếu build trong laravel thì ok , nhưng cần realtime khi có api gửi tới thì không làm được . 
        => Thêm nữa là lỡ cái này nó tính phí . 
        + Cái này có một cái lợi đó là chỉ cần chọn frontend và backend là nó tự sinh code cho mình luôn, khá là ok 

    + Đầu từ làm Socket luôn . 


================================================================
https://socialiteproviders.com/about/#provider-issues

php artisan make:model Articles -c -v 


================================================================
Có một cái cực kì hay mà mình đã làm rồi đó là => Đang thiếu , chưa use một class nào đó 
thì chỉ cần viết class đó ra rồi khi từ cuối cùng => đường dẫn class hiện lên 
ta chỉ cần 'enter' một cái là laravel tự thêm class đó cho ta 
CHÚ Ý : Nhưng chú ý là giả sử có nhiều class cùng tên thì nên xem kĩ trước khi enter tránh use nhầm class không cần
Ví dụ : 
    + $user = Auth::user();
    => Auth => enter => tự động có use Illuminate\Support\Facades\Auth; 
================================================================
Route . Có 2 cách 
Cách 1 : Không đặt name cho route 
    Route::prefix('article')->controller(ArticlesController::class)->group(function () {
        Route::middleware(['auth'])->group(function () {
            Route::post('/add', 'addArticle');
        });
    });

    thì action trong form sẽ là 
    <form method="POST" action="/article/add"> 

Cách 2 : Đặt name cho route 
    Route::prefix('article')->controller(ArticlesController::class)->name('article.')->group(function () {
        Route::middleware(['auth'])->group(function () {
            Route::post('/add', 'addArticle')->name('add');
        });
    });

    thì action trong form sẽ là 
    <form method="POST" action="{{ route('article.add') }}"> 

=> nói chung cách nào cũng được , nhưng thấy cách đặt name ok hơn 
================================================================
Add Article 
    C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel>php artisan make:request RequestArticle
    C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel\app\Http\Requests\RequestArticle.php
        <?php

            namespace App\Http\Requests;

            use Brian2694\Toastr\Facades\Toastr;
            use Illuminate\Foundation\Http\FormRequest;

            class RequestArticle extends FormRequest
            {
                public function authorize()
                {
                    return true;
                }

                public function rules()
                {
                    return [
                        'title' => 'required|min:6',
                        'content' => 'required|min:6',
                    ];
                }

                public function withValidator($validator)
                {
                    if ($validator->fails()) {
                        foreach ($validator->errors()->all() as $error) {
                            Toastr::error($error);
                        }
                    }
                }
            }

    C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel\app\Http\Controllers\ArticlesController.php
        public function addArticle(RequestArticle $request){
            $request->validated();
            $data = $request->all();
            $user = Auth::user();
            $article = Articles::create([
                'id_user' => $user->id,
                'title' => $data['title'],
                'content' => $data['content'],
            ]);
            if ($article) {
                Toastr::success('Thêm bài viết thành công!');
                return redirect()->route('article.add'); 
            } else {
                Toastr::error('Thêm bài viết thất bại!');
                return redirect()->back()->withInput(); // Quay trở lại trang trước đó và giữ lại dữ liệu đã nhập
            }
        }

Note : 
    + Nếu muốn in ra được các lỗi thì ta phải tự tạo request cho nó (bằng câu lệnh trên)
        + nếu dùng request như thông thường như thế này 
            public function addArticle(Request $request){
                $request->validated([
                    'title' => 'required|min:6',
                    'content' => 'required|min:6',
                ]);

                dd(1);  <== thì nếu khi gặp lỗi , dòng này sẽ không được in ra 
                nó kiểm tra nếu có lỗi trong rule thì sẽ chuyển về lại ngay , chứ không thực hiện tiếp
                
    + Chính vì thế phải tạo request riêng cho nó => và muốn in ra các lỗi trong rule thì code vào hàm 
        withValidator như đoạn code trên 

    + Nhắt lại : validated([...]) là một hàm có sẵn của laravel 

Nói thêm : 
    + Ta có thể tối ưu hơn nữa , in ra lỗi tùy ý bằng cách custom lại error 
        + Ví dụ rule : require sẽ in ra gì , min:6 sẽ in ra gì ,... 
        => cái này sẽ code lại sau 

    + return redirect()->route('article.add');  // chuyển đến trang có name route là 'article.add' (chính là của article. + add)
    + return redirect()->back()->withInput();   // Quay trở lại trang trước đó và giữ lại dữ liệu đã nhập
    + bên html thì dùng old() để hiển thị lại các giá trị cũ (nếu form lỗi)
    <input value="{{ old('title') }}" name="title" type="text" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="Enter email">


================================================================
Pagination in Laravel 8 
    + https://dev.to/codeanddeploy/laravel-8-pagination-example-using-bootstrap-5-243h
    + C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel\app\Providers\AppServiceProvider.php
            <?php
                namespace App\Providers;
                
                use Illuminate\Support\ServiceProvider;
                use Illuminate\Pagination\Paginator;   <==== 
                
                class AppServiceProvider extends ServiceProvider
                {
                    public function register()
                    {
                    }
                    public function boot()
                    {
                        Paginator::useBootstrap();    <==== 
                    }
                }
    
    + C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel\app\Http\Controllers\ArticleController.php
        public function myArticle(Request $request){
            $user = Auth::user();
            $articles = Article::where('id_user', $user->id)->paginate(2);
            return view('article.MyArticle',['articles' => $articles]);
        }

    + C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel\resources\views\article\MyArticle.blade.php
        + Có 2 cách , cách nào cũng được : 
        {{ $articles->links() }}
        {!! $articles->links() !!}

    + Nói thêm : 
        + npm i jquery
        + npm install bootstrap@4.0.0

        + C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel\resources\views\dashboard.blade.php
            <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet">
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
            <link rel="stylesheet" href="http://cdn.bootcss.com/toastr.js/latest/css/toastr.min.css"> 

            <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
            <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>     


    + http://localhost:8000/article/my?page=2
        Illuminate\Pagination\LengthAwarePaginator {#1398 ▼
            #total: 5
            #lastPage: 1
            #items: Illuminate\Database\Eloquent\Collection {#1421 ▶}
            #perPage: 6
            #currentPage: 2
            #path: "http://localhost:8000/article/my"
            #query: []
            #fragment: null
            #pageName: "page"
            +onEachSide: 3
            #options: array:2 [▶]
        }
        + Thông số của Pagination trong laravel 
            + perPage : số dòng trên mỗi trang (lấy ra bao nhiêu cái trên mỗi trang)
            + currentPage : trang hiện tại mà mình đang đứng 
                + Khi click vào http://localhost:8000/article/my thì nó hiện ra 
                => khi click vào các trang thì url sẽ tự động thay đổi theo , ví dụ click vào 2 
                thì ta được : http://localhost:8000/article/my?page=2 
                => click vào 1,2,3... thì cũng tương tự 
            + total : tổng số result mà backend lấy ra được 
            + lastPage : trang trước đó 

        + Từ 2 thông số perPage, currentPage ta có thể lấy ra được index hay số thứ tự 
        bằng cách : 
            @foreach ($articles as $index => $article)
            <tr>
                <td>{{ $articles->perPage()*($articles->currentPage() -1) + $index + 1 }}</td>
                <td>{{ $article->title }}</td>
                <td>{{ $article->content }}</td>
                <td>{{ $article->content }}</td>
                <td><button type="button" class="btn btn-primary">Primary</button></td>
                <td><button type="button" class="btn btn-danger">Danger</button></td>
            </tr>
            @endforeach
        
        + Thay vì @foreach ($articles as $article) thì để có thêm số thứ tự ta phải : @foreach ($articles as $index => $article)

================================================================
Eloquent Laravel 8 . As name 

$articles = Article::join('users', 'articles.id_user', '=', 'users.id')
    // ->select('articles.*', 'users.name') // nếu không có as thì mặc định nó sẽ là name 
    ->select('articles.*', 'users.name as author') // nếu as thì để đặc tên lại cho nó  
    ->paginate(2);
    dd($articles);

#attributes: array:7 [▼
    "id" => 2
    "id_user" => 1
    "title" => "ascsacasc"
    "content" => "ascascsac"
    "created_at" => "2023-06-30 16:09:49"
    "updated_at" => "2023-06-30 16:09:49"
    "name" => "Nguyen Van Manh"    <=== không đặt tên 
]

#attributes: array:7 [▼
    "id" => 2
    "id_user" => 1
    "title" => "ascsacasc"
    "content" => "ascascsac"
    "created_at" => "2023-06-30 16:09:49"
    "updated_at" => "2023-06-30 16:09:49"
    "author" => "Nguyen Van Manh"    <=== đặt lại tên  
]

LƯU Ý : CÁC TRƯỜNG CÓ TÊN TRÙNG NHAU . Ví dụ 
$articles = Article::join('users', 'articles.id_user', '=', 'users.id')
    ->select('articles.*', 'users.id') 
    ->paginate(2);
    dd($articles);

=> Ta thấy article cũng có id mà user cũng có trường id => trường id của user sẽ đè lên trường id của 
    article . Lúc này sẽ không có 7 thuộc tính nữa mà sẽ là 6 thuộc tính thôi 
        #attributes: array:6 [▼
            "id" => 1
            "id_user" => 1
            "title" => "ascsacasc"
            "content" => "ascascsac"
            "created_at" => "2023-06-30 16:09:49"
            "updated_at" => "2023-06-30 16:09:49"
        ]
=> ĐÂY LÀ LÝ DO MÀ CẦN PHẢI DÙNG AS ĐỂ ĐẶT LẠI NAME . NẾU KHÔNG TRÙNG THÌ THÍCH THÌ ĐẶT AS KHÔNG THÌ KHÔNG CŨNG ĐƯỢC . 
================================================================
Để lấy thông tin của người đăng nhập ngay trên blade trong Laravel, bạn có thể sử dụng biến toàn cục auth(). 
Dưới đây là một số ví dụ về cách lấy thông tin người đăng nhập:
    Lấy thông tin người đăng nhập hiện tại (Instance của Model User):
        $user = auth()->user();
    Lấy ID của người đăng nhập:
        $userID = auth()->id();
    Kiểm tra xem người dùng có đăng nhập hay không:
        if (auth()->check()) {
            // Người dùng đã đăng nhập
        }
    Kiểm tra xem người dùng có phải là một vai trò cụ thể hay không:
        if (auth()->user()->hasRole('admin')) {
            // Người dùng có vai trò admin
        }
    Trong các ví dụ trên, auth() là một trợ giúp để truy cập vào đối tượng Illuminate\Contracts\Auth\Guard, và thông qua đối tượng này, bạn có thể truy cập vào thông tin của người đăng nhập hiện tại.
    Sau khi lấy thông tin của người đăng nhập, bạn có thể sử dụng nó để hiển thị thông tin tùy ý trong blade. Ví dụ:
        <p>Welcome, {{ auth()->user()->name }}</p>
        <p>Email: {{ auth()->user()->email }}</p>
    Lưu ý rằng để sử dụng auth(), bạn cần chắc chắn rằng đã kích hoạt tính năng xác thực trong ứng dụng Laravel của bạn và đã đăng nhập thành công.

+ C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel\resources\views\article\Index.blade.php
@foreach ($articles as $index => $article)
<tr>
    <td>{{ $articles->perPage()*($articles->currentPage() -1) + $index + 1 }}</td>
    <td>{{ $article->title }}</td>
    <td>{{ $article->content }}</td>
    <td>{{ $article->name }}</td>
    <td><button type="button" class="btn btn-primary"><i class="fa-solid fa-eye"></i> View</button></td>
    @if($article->id_user == auth()->user()->id)
    <td><button type="button" class="btn btn-primary"><i class="fa-solid fa-pen-to-square"></i> Edit</button></td>
    <td><button type="button" class="btn btn-danger"><i class="fa-solid fa-trash"></i> Delete</button></td>
    @endif 
</tr>
@endforeach
================================================================
Để hiển thị giá trị được truyền về từ controller và vẫn sử dụng old để hiển thị giá trị cũ, 
bạn có thể sửa code blade như sau:
<form method="POST" action="{{ route('article.add') }}">
    @csrf
    <div class="form-group">
        <label for="title">Title</label>
        <input value="{{ old('title', $article->title) }}" name="title" type="text" class="form-control" id="title" aria-describedby="titleHelp" placeholder="Title">
    </div>
    <div class="form-group">
        <label for="content">Content</label>
        <textarea name="content" class="form-control" id="content" rows="5" placeholder="Content">{{ old('content', $article->content) }}</textarea>
    </div>
    <button type="submit" class="btn btn-primary">Add</button>
</form>
Trong ví dụ trên, chúng ta sử dụng old('field', $value) để hiển thị giá trị cũ của trường và nếu không có giá trị cũ, 
nó sẽ lấy giá trị từ biến $article được truyền từ controller. Điều này cho phép bạn hiển thị giá trị trước đó nếu có, 
hoặc giá trị mặc định từ bài viết nếu không có giá trị cũ.

=> Đảm bảo khi mới vào thì hiển thị giá trị được truyền về , còn khi update mà lỗi thì giữ nguyên các giá trị cũ cho người dùng 
để người dùng tiếp tục chỉnh sửa, chỉ khi lỗi mà người dùng không chỉnh sửa nữa mà request lại thì nó vẫn cứ theo quy tắc như trên 
là hiển thị các giá trị được truyền về . 
================================================================
Delete Article 
C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel\resources\views\article\Index.blade.php
    <td>
        {{-- $article->id là truyền vào route 1 giá trị , còn ['id' => $article->id] là truyền vào nhiều giá trị --}}
        <form action="{{ route('article.delete', $article->id) }}" method="POST" onsubmit="return confirm('Are you sure you want to delete this article?');">
            @csrf
            @method('DELETE')
            <button type="submit" class="btn btn-danger"><i class="fa-solid fa-trash"></i> Delete</button>
        </form>
    </td>
    
C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel\app\Http\Controllers\ArticleController.php
    Dưới đây là mã code cho hàm deleteArticle trong controller:
    public function deleteArticle(Request $request, $id)
    {
        // Kiểm tra xem người dùng có quyền xóa bài viết hay không
        // Ví dụ: Chỉ cho phép người tạo bài viết hoặc người có quyền quản trị xóa
        $article = Article::findOrFail($id); // tìm không thấy bài viết thì về lại 
        $user = Auth::user();
        $article = Article::where('id',$request->id)->first();
        if($user->id == $article->id_user){
        // if ($request->user()->can('delete', $article)) {
            // Xóa bài viết
            $article->delete();
            Toastr::success('Xóa bài viết thành công !');
            return redirect()->back();
        } else {
            Toastr::error('Bạn không có quyền xóa bài viết !');
            return redirect()->back();
        }
    }
    Trong ví dụ trên, chúng ta sử dụng findOrFail($id) để tìm bài viết dựa trên id. Sau đó, chúng ta kiểm tra xem người dùng 
    có quyền xóa bài viết hay không, ví dụ: chỉ cho phép người tạo bài viết hoặc người có quyền quản trị xóa. Nếu người dùng có quyền, 
    chúng ta xóa bài viết và chuyển hướng về trang trước với thông báo thành công. Nếu người dùng không có quyền, chúng ta chuyển hướng 
    về trang trước với thông báo lỗi.

C:\Users\ADMIN\Downloads\ProLaravel\bloglaravel\routes\web.php
    Route::post('/delete/{id}', 'deleteArticle')->name('delete');
